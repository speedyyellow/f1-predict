<!-- Basic page layout -->
{% extends "predict/base.html" %}

{% block header-heading %}
Race Overview
{% endblock %}

<!-- The main page content -->
{% block page-content %}
{% if race %}
<div class="row">
    <div class="small-12 panel columns">
        <div class="small-10 columns">
            {% if user.is_staff %}
            <h3><a href="/{{race.season.name}}/result/{{race.circuit.country}}">{{race.season.name}} {{race.circuit.country}} Grand Prix</a></h3>
            {% else %}
            <h3>{{race.season.name}} {{race.circuit.country}} Grand Prix</h3>
            {% endif %}
        </div>
        <div class="small-2 columns">
            <h3>{{round_score}} points</h3>
        </div>
        <div class="small-5 columns">
            <h5>{{race.circuit.name}}</h5>
        </div>
        <div class="small-5 columns">
            <h5>{{race.event_date|date:"d F"}} - {{race.race_date|date:"d F Y"}}</h5>
        </div>
        <div class="small-2 columns">
            <h3></h3>
        </div>
    </div>
</div>
{% endif %}


{% if results %}
<div class="row">
    <div class="small-12 panel columns">
        <div class="small-9 columns">
            <h4>{{race.season.name}} Results</h4>
        </div>
        <div class="small-3 columns">
            <h4>Prediction</h4>
        </div>
        <div class="small-9 columns">
            <h5>Pole: <a href='/{{race.season.name}}/driver/{{result.pole_position.driver.id}}'>{{result.pole_position.driver.name}}</a></h5>
        </div>
        <div class="small-3 columns">
            <h5><a href='/{{race.season.name}}/driver/{{prediction.pole_position.driver.id}}'>{{prediction.pole_position.driver.name}}</a></h5>
        </div>
        <div class="small-9 columns">
            <h5>Fastest Lap: <a href='/{{race.season.name}}/driver/{{result.fastest_lap.driver.id}}'>{{result.fastest_lap.driver.name}}</a></h5>
        </div>
        <div class="small-3 columns">
            <h5><a href='/{{race.season.name}}/driver/{{prediction.fastest_lap.driver.id}}'>{{prediction.fastest_lap.driver.name}}</a></h5>
        </div>
        <div class="small-12 columns">
            <table class="fullwidth">
                <tr>
                    <th>Pos</th>
                    <th>Driver</th>
                    <th>Constructor</th>
                    <th>Points</th>
                    <th>Prediction</th>
                </tr>
                {% for pos, points, dname, dkey, tname, tkey, pname, pkey in table %}
                <tr>
                    <td>{{pos}}</td>
                    <td><a href='/{{race.season.name}}/driver/{{dkey}}'>{{ dname }}</a></td>
                    <td><a href='/{{race.season.name}}/team/{{tkey}}'>{{ tname }}</a></td>
                    <td>{{points}}</td>
                    <td><a href='/{{race.season.name}}/driver/{{pkey}}'>{{ pname }}</a></td>
                    <td></td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>
{% else %}
<div class="row">
    <div class="small-12 panel columns">
        <div class="small-12 columns">
            <h4>{{race.season.name}} Results</h4>
        </div>
        <div class="small-12 columns">
            <p>No results yet</p>
        </div>
    </div>
</div>{% endif %}

{% if last_results %}
<div class="row">
    <div class="small-12 panel columns">
        <div class="small-12 columns">
            <h4>{{last_race.season.name}} Results</h4>
        </div>
        <div class="small-9 columns">
            <h5>Pole: <a href='/{{last_race.season.name}}/driver/{{last_result.pole_position.driver.id}}'>{{last_result.pole_position.driver.name}}</a></h5>
        </div>
        <div class="small-9 columns">
            <h5>Fastest Lap: <a href='/{{last_race.season.name}}/driver/{{last_result.fastest_lap.driver.id}}'>{{last_result.fastest_lap.driver.name}}</a></h5>
        </div>
        <div class="small-12 columns">
            <table class="tablesaw">
                <tr>
                    <th>Pos</th>
                    <th>Driver</th>
                    <th>Constructor</th>
                    <th>Points</th>
                </tr>
                {% for entry in last_results %}
                <tr>
                    <td>{{ entry.position.position }}</td>
                    <td><a href='/{{race.season.name}}/driver/{{entry.driver.driver.id}}'>{{ entry.driver.driver.name }}</a></td>
                    <td><a href='/{{race.season.name}}/team/{{entry.driver.team.id}}'>{{ entry.driver.team.name }}</a></td>
                    <td>{{ entry.position.points }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}
